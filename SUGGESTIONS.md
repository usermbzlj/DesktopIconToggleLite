# 改进建议

- 引入日志抽象：建议在 `TrayContext` 中封装一个简单的日志输出类，支持写入到 `%APPDATA%/a6.DesktopIconToggleLite/log.txt`，以便追踪热键注册失败、鼠标钩子异常等问题，便于排查用户环境差异。
- 优化配置加载：在 `Config.Load` 失败时，可记录详细异常信息，并在 UI 中弹出提示，提醒用户检查 JSON 格式或者权限问题。
- 自动检测更新：考虑增加一个可选的“检查更新”配置项，启动时以异步方式访问版本信息（例如 GitHub Releases），发现新版本时在托盘菜单提示。
- 全屏检测策略：当前通过窗口矩形与屏幕比较，建议兼容多显示器场景下的 DPI 缩放误差，或提供一个阈值配置，避免某些游戏窗口被误判。
- 热键冲突处理：当注册热键失败时，可在托盘菜单中提供“选择新热键”的对话框，并将失败原因写入日志，同时提示用户可能被其他程序占用。
- 钩子资源管理：建议在应用即将退出时，先暂停鼠标钩子定时器，再调用 `UnhookWindowsHookEx`，并在异常情况下重试，以减少残留钩子的风险。
- 自启动状态同步：在启动时同步读取注册表实际状态，如果外部删除了自启动项，应当回写至配置文件并更新菜单勾选状态，保持 UI 与真实状态一致。
